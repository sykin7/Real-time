
# Secure Chat Ultra ğŸš€

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Supabase** (BaaS) æ„å»ºçš„ç°ä»£åŒ–ã€å®æ—¶ã€å®‰å…¨çš„ 1å¯¹1 ç½‘é¡µèŠå¤©å®¤ã€‚
æ— éœ€ç¼–å†™å¤æ‚çš„åç«¯ä»£ç ï¼Œé€šè¿‡çº¯å‰ç«¯ (HTML/JS) + å¼ºå¤§çš„æ•°æ®åº“ç­–ç•¥ (RLS) å®ç°ä¼ä¸šçº§çš„èŠå¤©åŠŸèƒ½ã€‚
**å†…ç½®è‡ªåŠ¨ä¿æ´»æœºåˆ¶ï¼Œè§£å†³ Supabase å…è´¹ç‰ˆè‡ªåŠ¨ä¼‘çœ é—®é¢˜ã€‚**

![Status](https://img.shields.io/badge/Status-Active-success)
![Docker](https://img.shields.io/badge/Docker-Supported-blue)
![Supabase](https://img.shields.io/badge/Supabase-Free%20Tier-green)
![Uptime](https://img.shields.io/badge/Uptime-Forever-orange)

## âœ¨ æ ¸å¿ƒäº®ç‚¹

* **ğŸ¤– æ°¸ä¸ä¼‘çœ **ï¼šé›†æˆ GitHub Actions å®šæ—¶ä»»åŠ¡ï¼Œæ¯æ—¥è‡ªåŠ¨å”¤é†’æ•°æ®åº“ï¼Œé˜²æ­¢å…è´¹ç‰ˆé¡¹ç›®æš‚åœã€‚
* **ğŸ”’ æè‡´å®‰å…¨**ï¼šé‡‡ç”¨ Supabase RLS (è¡Œçº§å®‰å…¨ç­–ç•¥)ï¼Œåªæœ‰å‘ä»¶äººå’Œæ”¶ä»¶äººèƒ½çœ‹åˆ°æ¶ˆæ¯ã€‚
* **âš¡ï¸ å®æ—¶é€šè®¯**ï¼šåŸºäº WebSocket çš„å®æ—¶æ¶ˆæ¯æ¨é€ï¼Œæ¯«ç§’çº§å»¶è¿Ÿã€‚
* **ğŸ“± æè‡´ä½“éªŒ**ï¼š
    * ä»¿ WhatsApp/Telegram ç°ä»£åŒ– UIã€‚
    * **å¼€å±åŠ è½½åŠ¨ç”»**ä¸**æ™ºèƒ½æ»šå±**ã€‚
    * **æ—¥æœŸåˆ†å‰²çº¿**ä¸**æ¶ˆæ¯çŠ¶æ€åé¦ˆ**ã€‚
    * å®Œç¾é€‚é…ç§»åŠ¨ç«¯ï¼ˆè§£å†³é”®ç›˜é®æŒ¡é—®é¢˜ï¼‰ã€‚
    * æ–­ç½‘è‡ªåŠ¨æ£€æµ‹ä¸é‡è¿æç¤ºã€‚
* **ğŸ³ Docker åŒ–**ï¼šæ”¯æŒç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œã€‚

---

## ğŸ› ï¸ åç«¯é…ç½® (Supabase)

åœ¨è¿è¡Œä¹‹å‰ï¼Œè¯·å…ˆåœ¨ [Supabase](https://supabase.com) åˆ›å»ºä¸€ä¸ªå…è´¹é¡¹ç›®ã€‚

### 1. åˆå§‹åŒ–æ•°æ®åº“
åœ¨ Supabase åå°çš„ **SQL Editor** ä¸­è¿è¡Œä»¥ä¸‹ SQLï¼š

```sql
DROP TABLE IF EXISTS messages;

CREATE TABLE messages (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  content text,
  sender_email text,
  receiver_email text
);

ALTER TABLE messages ENABLE ROW LEVEL SECURITY;

CREATE POLICY "See own messages"
ON messages FOR SELECT
USING (
  auth.jwt() ->> 'email' = sender_email
  OR
  auth.jwt() ->> 'email' = receiver_email
);

CREATE POLICY "Send messages"
ON messages FOR INSERT
WITH CHECK (
  auth.jwt() ->> 'email' = sender_email
);

ALTER PUBLICATION supabase_realtime ADD TABLE messages;
````

### 2\. å…³é—­é‚®ç®±éªŒè¯

è¿›å…¥ **Authentication** -\> **Providers** -\> **Email**ï¼Œ**å…³é—­ Confirm email**ï¼Œä¿å­˜ã€‚

-----

## ğŸ¤– è‡ªåŠ¨ä¿æ´»é…ç½® (Auto Keep-alive)

ä¸ºäº†é˜²æ­¢ Supabase å…è´¹ç‰ˆå›  7 å¤©æ— è®¿é—®è€Œæš‚åœï¼Œæœ¬é¡¹ç›®åŒ…å«ä¸€ä¸ª GitHub Action è„šæœ¬ã€‚

1.  **Fork æˆ–ä¸Šä¼ **æœ¬é¡¹ç›®åˆ°ä½ çš„ GitHub ä»“åº“ã€‚
2.  è¿›å…¥ä»“åº“ **Settings** -\> **Secrets and variables** -\> **Actions**ã€‚
3.  æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ª Repository Secretsï¼š
      * `SUPABASE_URL`: ä½ çš„ Supabase é¡¹ç›®ç½‘å€ (https://www.google.com/search?q=https://....supabase.co)
      * `SUPABASE_KEY`: ä½ çš„ `anon` å…¬é’¥ (sb\_publishable\_...)
4.  é…ç½®å®Œæˆåï¼Œ`.github/workflows/keep-alive.yml` ä¼šåœ¨**æ¯å¤© UTC 0:00 (åŒ—äº¬æ—¶é—´ 8:00)** è‡ªåŠ¨è¿è¡Œä¸€æ¬¡ï¼Œç¡®ä¿æ•°æ®åº“å¤„äºæ´»è·ƒçŠ¶æ€ã€‚

-----

## ğŸ’» è¿è¡Œæ–¹å¼

### æ–¹å¼ä¸€ï¼šæœ¬åœ°ç›´æ¥è¿è¡Œ (HTML)

1.  ä¸‹è½½ `index.html`ã€‚
2.  ç”¨ç¼–è¾‘å™¨æ‰“å¼€ï¼Œä¿®æ”¹é¡¶éƒ¨çš„é…ç½®ï¼š
    ```javascript
    // æ›¿æ¢ä¸ºä½ çš„çœŸå®ä¿¡æ¯
    const SUPABASE_URL = '[https://ä½ çš„é¡¹ç›®ID.supabase.co](https://ä½ çš„é¡¹ç›®ID.supabase.co)'
    const SUPABASE_KEY = 'sb_publishable_ä½ çš„Key...'
    ```
3.  åŒå‡»æ‰“å¼€å³å¯ä½¿ç”¨ã€‚

### æ–¹å¼äºŒï¼šDocker éƒ¨ç½² (æ¨è)

æ— éœ€ä¿®æ”¹ä»£ç ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥é…ç½®ã€‚

**æ„å»ºï¼š**

```bash
docker build -t secure-chat .
```

**è¿è¡Œï¼š**

```bash
docker run -d -p 80:80 \
  -e SUPABASE_URL="ä½ çš„çœŸå®URL" \
  -e SUPABASE_KEY="ä½ çš„çœŸå®KEY" \
  secure-chat
```

-----

## ğŸ“‚ é¡¹ç›®ç»“æ„

| æ–‡ä»¶ | è¯´æ˜ |
| :--- | :--- |
| `index.html` | æ ¸å¿ƒå‰ç«¯ä»£ç  (å•æ–‡ä»¶ï¼Œé›¶ä¾èµ–) |
| `Dockerfile` | å®¹å™¨æ„å»ºæ–‡ä»¶ |
| `entrypoint.sh` | ç¯å¢ƒå˜é‡æ³¨å…¥è„šæœ¬ |
| `.github/workflows/docker-image.yml` | è‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒ Docker é•œåƒ |
| `.github/workflows/keep-alive.yml` | **æ•°æ®åº“è‡ªåŠ¨ä¿æ´»è„šæœ¬** |

-----

## âš ï¸ æ³¨æ„äº‹é¡¹

  * è¯·å‹¿å°†å«æœ‰çœŸå® Key çš„ `index.html` ç›´æ¥æäº¤åˆ°å…¬å¼€ä»“åº“ï¼Œå»ºè®®ä½¿ç”¨ Docker ç¯å¢ƒå˜é‡æ–¹å¼éƒ¨ç½²ã€‚
  * RLS ç­–ç•¥ç¡®ä¿äº†å³ä½¿ Key æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿæ— æ³•æŸ¥çœ‹ä»–äººæ•°æ®ã€‚

-----

## ğŸ“„ License

MIT License.

```
```
